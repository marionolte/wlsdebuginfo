<%-- 
    Document   : index
    Created on : Jun 19, 2019, 4:45:13 AM
    Author     : SuMario
--%>
<%@ page import="java.util.*,java.io.*,java.net.*" %>
<%

    String version=service.Version.getVersion();
    String mySid = (String) session.getAttribute("mysid");
    if ( mySid == null  )  {
        mySid=session.getId();
    }
    session.setAttribute("mysid", mySid);
    String OK="#000080";
    String FAILED="#FF1111";
%>

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>CNVD-C-2019-48814 - CVE Base Check - Version <%out.print(version);%></title>
    </head>
    <body>
        <h1>CNVD-C-2019-48814 - CVE Base Check - Version <%out.print(version);%></h1>
        
<pre>
Test with whoami :
<%
        int c=0; 
        String testu = request.getScheme() +"://"+ request.getServerName()+ ":"+request.getServerPort()+"/_async/AsyncResponseService";
        out.println("<BR />URL test weblogic async request  against <a href=\""+testu+"\" >"+testu+"</a>");
        HttpURLConnection ht = (HttpURLConnection) ( new URL(testu)).openConnection();  
        ht.setReadTimeout(15000);
	ht.setDoOutput(true); 
    	ht.setInstanceFollowRedirects(false); 
        ht.setRequestMethod("POST"); 
        ht.setRequestProperty("Content-Type", "text/plain"); 
        ht.setRequestProperty("charset", "utf-8");

        ht.connect();
        int call = ht.getResponseCode();

        out.println("RESPONSECODE : "+call );
        c = ( call == 404 || call == 401 )?0:1;

out.println("\n</pre>");
	if ( c != 0 ) {
   		out.println("<span style=\"color:"+FAILED+"\" >FAILED</span>");
	} else {
		out.println("<span style=\"color:"+OK+"\" >OK</span>");	
	}

%>

    </body>
</html>
